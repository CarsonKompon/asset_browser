@using Sandbox;
@using Sandbox.UI;
@implements IInspector
@namespace Browser
@attribute [StyleSheet]

<root>
    <label>@Text</label>
</root>

@code
{
    public BaseFileSystem FileSystem { get; set; }
    public string Path { get; set; }

    string Text { get; set; }

    protected override void OnAfterTreeRender(bool firstRender)
    {
        base.OnAfterTreeRender(firstRender);

        if (firstRender)
        {
            LoadText();
        }
    }

    async void LoadText()
    {
        if (FileSystem.FileSize(Path) > 10000)
        {
            Text = "File too large to display";
            return;
        }
        Text = await FileSystem.ReadAllTextAsync(Path);
        StateHasChanged();
    }

    protected override int BuildHash() => System.HashCode.Combine(Path, Text);
}